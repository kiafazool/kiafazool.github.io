<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<a href="https://plus.google.com/106183157602618292373?rel=author">Google</a>
	<a href="https://plus.google.com/106183157602618292373" rel="publisher">Find us on Google+</a>
	<title>Total Harmonic Distortion (THD)</title>
	<link rel="canonical" href="http://onmyphd.com/p_thd/" />
	<meta name="google-site-verification" content="qS-ONqo-b5-NzkWSBgPnv5l5gN7ddcorKuN6ZAfnAoI"/>
	<meta name="description" content="The THD measures the nonlinearity of a system. It is defined as the ratio between the power of all harmonics and the power in the fundamental frequency of a signal.">
	<meta name="keywords" content="total harmonic distortion, THD, ratio, definition, fundamental frequency, harmonics, THD+N">
	<meta name="author" content="Hugo GonÃ§alves"> 
	<meta property="fb:admins" content="100004669092914"/>
	<!-- Auto ads by google -->
	<!-- end -->
	<script>
	// Google Analytics
	</script>
</head>
<body>
<script src="../ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>
 var page = 'thd';// Add event listener compatible with all browsers
function addEvent(e, ev, f) {
	// W3C DOM || IE DOM
	if (e.addEventListener) e.addEventListener(ev,f,false)
	else if (e.attachEvent) e.attachEvent("on"+ev, f);
}
// Asynchronous load of script
function loadJS(src, callback) {
	var e = document.createElement('script'); e.type = 'text/javascript'; e.async = true; e.src = src;
	if (callback) addEvent(e, 'load', callback);
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
}
function loadJSonce(src, id, callback) {
	var s = document.getElementsByTagName('script')[0];
	if(!s.getElementById(id)) loadJS(src, callback);
}
function r(obj, f) {
	var a = [].slice.call(arguments);
	var f = a[a.length - 1];
	f.apply(undefined, a.slice(0,-1));
}
_jQ = jQuery;
_phd = jQuery.phd;
</script>
<script type="text/javascript" src="../components/js/phd.js"></script>
<div id="logo"><a id="about.me" class="page" href="/" style="color:white">OnMyPhD</a></div>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.async = true;
  js.src = "http://connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div id="fb" class="fb-like" data-href="http://www.facebook.com/onmyphd" data-send="false" data-width="60" data-show-faces="false" data-colorscheme="dark" width="60" data-layout="button_count"></div>
<div id="search">
<input id="searchbox" class="searchempty" type="text" value="Search..."/>
</div>
<div id="top"></div>
<div id="pages">
<h1>Total Harmonic Distortion (THD)</h1>
<h2>What do you need to know to understand this topic?</h2>
<ul>
<li>Power Spectral Density (PSD)</li>
<li><a href="../p_harmonics/" id="harmonics" class="page">Harmonics</a></li>
</ul>
<h2>What is Total Harmonic Distortion (THD)?</h2>
<p>
Total Harmonic Distortion measures how much of a waveform power is distortion caused by harmonics. If the fundamental frequency of the signal is $f_1$ with power $P_1$, and the harmonics $i$ are at $f_i$ with power $P_i$, the THD is:
$$ THD = \frac{\sum_{i&gt;1} P_i}{P_1} = \frac{P_{total} - P_1}{P_1}$$
where $P_{total}$ is the total power of the waveform (signal + harmonics). In other words, the <b>Total Harmonic Distortion is the ratio of the power of all the harmonics with the power in the fundamental frequency.</b>.
</p>
<p>
The THD measures the nonlinearity of a system, while applying a single sinusoidal to it. The sinusoidal, when applied to a nonlinear system, will produce an output with the same fundamental frequency as of the sinusoidal input, but will also generate harmonics at multiples of the fundamental frequency. To understand why that happens, check the <a href="../p_harmonics/" id="harmonics" class="page">harmonics</a> topic.
</p>
<p>
Squared RMS voltages are equivalent to power and can replace it in the THD equation:
$$ THD = \frac{\sum_{i&gt;1} V_i^2}{V_1^2} = \frac{V_{total}^2 - V_1^2}{V_1^2}$$
However, <b>in some situations THD is defined as an amplitude ratio</b>, instead of a power ratio:
$$ THD_{amp} = \frac{\sqrt{\sum_{i&gt;1} V_i^2}}{V_1} = \frac{\sqrt{V_{total}^2 - V_1^2}}{V_1} = \sqrt{THD} $$
which leads to a value that is the square root of the other definition.
</p>
<h3>How to measure the THD?</h3>
<p>
The THD can be measured in the following way: from a set of samples of the waveform, compute the Fourier transform to get the frequency spectrum. From there, sum the harmonics power and divide by the power in the fundamental frequency.
</p>
<h2>What is Total Harmonic Distortion + Noise (THD+N)?</h2>
<p>
THD+N is just the THD accounting with noise, i.e.:
$$\begin{equation}THD+N = \frac{\sum_{i&gt;1} P_i + P_{noise}}{P_1} = \frac{P_{total} - P_1}{P_1} \label{eq:thdn}\end{equation}$$
where $P_{total}$ now includes the noise power.
</p>
<h3>How to measure the THD+N</h3>
<p>
With a notch filter (band-reject), remove the band where the fundamental frequency lies. The remaining power will be the harmonics and noise. Now subtract the remaining signal from the original signal, leaving only the power in the fundamental frequency (or use a pass-band filter to remove all bands except where the fundamental frequency lies) and from there you get $P_1$.
Another option is to measure the total power $P_{total}$ and use again the pass-band filter to extract $P_1$. Then you can use the second form of $\eqref{eq:thdn}$.
</p>
<script type="text/javascript" src="../pages/thd.js"></script>
<div id="social">
If I helped you in some way, please help me back by liking this website on the bottom of the page or clicking on the link below. It would mean the world to me!<p>
<table>
<tr>
<td width="100"><!-- Facebook -->
<div id="fb-like-page" class="fb-like" data-href="http://www.onmyphd.com/?p=thd" data-send="false" data-width="90" data-show-faces="false" data-layout="button_count"></div>
</td>
<td width="100"><!-- Google+ -->
<div class="g-plusone"></div>
<script type="text/javascript">
loadJS('../js/plusone.js');
</script>
</td>
<td width="100"><!-- Twitter -->
<a href="https://twitter.com/share" class="twitter-share-button" data-via="Onmyphd">Tweet</a>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.async=true;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script>
</td>
<td width="100"><!-- Linkedin -->
<script>
if (typeof (IN) != 'undefined') {
    IN.parse();
} else {
   loadJS("../in.js");
}
</script>
<script type="IN/Share" data-url="http://www.onmyphd.com/?p=thd" data-counter="right"></script>
</td>
</tr>
</table>
</div>
</div>
<div id="sidebar" style="position:absolute;width:250px;top:50px;left:940px;"></div>
<!-- <div id="poll1" style="position:absolute;width:250px;top:140px;left:940px;"></div>
<div id="poll2" style="position:absolute;width:250px;top:380px;left:940px;"></div>-->
<div id="menu">
<a id="mn_contents" class="page" href="../p_contents/">Contents</a> |
<a id="mn_resources" class="page" href="../p_resources/">Resources</a>
<!--<a id="mn_plot" class="page" href="?p=plot">Plot a chart</a>--> ||
<a id="mn_print" class="page" href="/">Print</a>
</div>
<div id="socialfixed"><b>Show your love:</b><br/><!-- Facebook -->
<span id="fb-like-page" class="fb-like" data-href="http://www.onmyphd.com/?p=thd" data-send="false" data-width="90" data-show-faces="false" data-layout="button_count"></span>
<!-- Google+ -->
<div class="g-plusone"></div>
<script type="text/javascript">
loadJS('../js/plusone.js');
</script>
<!-- Twitter -->
<a href="https://twitter.com/share" class="twitter-share-button" data-via="Onmyphd">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.async=true;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script>
<!-- Linkedin -->
<script>
if (typeof (IN) != 'undefined') {
    IN.parse();
} else {
   loadJS("../in.js");
}
</script>
<script type="IN/Share" data-url="http://www.onmyphd.com/?p=thd" data-counter="right"></script>
</div>
<div id="footer"><span id="message"></span></div>
<script>
jQuery (function ($) {
	// avoid loading javascript for the two main pages, as it would replicate the toc
	if (page != 'contents' && page != 'about.me' && page != '404')
	{
		$.phd.onload('#pages');
		$("#pages a.page").attr({rel: 'external', target: '_blank'});
		$.phd.cite('#pages');
		//$.phd.ads('#pages');
	}
	/*$('#searchbox').hide();
	$('#searchtoggle').click( function () {
		if ($('#searchbox').toggle().is(':visible')) {			
			$(this).html('Search &#x25B2;');
		} else {
			$(this).html('Search &#x25BC;');
		}
		return false;
	});*/
	// search box
	$('#searchbox')
	.focus( function () {
		if ( $(this).hasClass('searchempty') )
			$(this).val('').removeClass('searchempty')
	})
	.blur( function () {
		if ( $(this).val() == '' )
			$(this).val('Search...').addClass('searchempty');
	})
	.on('keydown', function (e) {
		if (e.which == 13) {
			window.open('http://www.google.com/search?sitesearch=onmyphd.com&q=' + $(this).val(), '_blank');
		}
    });
});
</script>
<link href="../main.css" rel="stylesheet" type="text/css">
</body>
</html>