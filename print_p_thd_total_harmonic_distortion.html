<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<title>Total Harmonic Distortion (THD)</title>
	<link rel="canonical" href="http://onmyphd.com/print_p_thd_total_harmonic_distortion/" />
	<meta name="description" content="The Total Harmonic Distortion (THD) measures the nonlinearity of a system. It is defined as the ratio between the power of all harmonics and the power in the fundamental frequency of a signal.">
	<meta name="keywords" content="total harmonic distortion, THD, ratio, definition, fundamental frequency, harmonics, THD+N">
	<meta name="author" content="Hugo GonÃ§alves"> 
	<meta property="fb:admins" content="100004669092914"/>		
</head>
<body>
<script src="../ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>
// Google Analytics
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-36174546-1']);
_gaq.push(['_trackPageview']);
loadJS(('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js');
 var page = 'thd.total.harmonic.distortion';// Add event listener compatible with all browsers
function addEvent(e, ev, f) {
	// W3C DOM || IE DOM
	if (e.addEventListener) e.addEventListener(ev,f,false)
	else if (e.attachEvent) e.attachEvent("on"+ev, f);
}
// Asynchronous load of script
function loadJS(src, callback) {
	var e = document.createElement('script'); e.type = 'text/javascript'; e.async = true; e.src = src;
	if (callback) addEvent(e, 'load', callback);
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
}
function loadJSonce(src, id, callback) {
	var s = document.getElementsByTagName('script')[0];
	if(!s.getElementById(id)) loadJS(src, callback);
}
function r(obj, f) {
	var a = [].slice.call(arguments);
	var f = a[a.length - 1];
	f.apply(undefined, a.slice(0,-1));
}
_jQ = jQuery;
_phd = jQuery.phd;
</script>
<script type="text/javascript" src="../components/js/phd.js"></script>
<div id="pages">
<p class="comment">Source: <a href="../p_thd.total.harmonic/">http://www.onmyphd.com/?p=thd.total.harmonic.distortion</a></p><h1>Total Harmonic Distortion (THD)</h1>
<h2>What do you need to know to understand this topic?</h2>
<ul>
<li>Power Spectral Density (PSD)</li>
<li><a href="../print.php/p_harmonics/" id="harmonics" class="page">Harmonics</a></li>
</ul>
<h2>What is Total Harmonic Distortion (THD)?</h2>
<p>
Total Harmonic Distortion measures how much of a waveform power is distortion caused by harmonics. If the fundamental frequency of the signal is $f_1$ with power $P_1$, and the harmonics $i$ are at $f_i$ with power $P_i$, the THD is:
$$ THD = \frac{\sum_{i&gt;1} P_i}{P_1} = \frac{P_{total} - P_1}{P_1}$$
where $P_{total}$ is the total power of the waveform (signal + harmonics). In other words, the <b>Total Harmonic Distortion is the ratio of the power of all the harmonics with the power in the fundamental frequency.</b>.
</p>
<p>
The THD measures the nonlinearity of a system, while applying a single sinusoidal to it. The sinusoidal, when applied to a nonlinear system, will produce an output with the same fundamental frequency as of the sinusoidal input, but will also generate harmonics at multiples of the fundamental frequency. To understand why that happens, check the <a href="../print.php/p_harmonics/" id="harmonics" class="page">harmonics</a> topic.
</p>
<p>
Squared RMS voltages are equivalent to power and can replace it in the THD equation:
$$ THD = \frac{\sum_{i&gt;1} V_i^2}{V_1^2} = \frac{V_{total}^2 - V_1^2}{V_1^2}$$
However, <b>in some situations THD is defined as an amplitude ratio</b>, instead of a power ratio:
$$ THD_{amp} = \frac{\sqrt{\sum_{i&gt;1} V_i^2}}{V_1} = \frac{\sqrt{V_{total}^2 - V_1^2}}{V_1} = \sqrt{THD} $$
which leads to a value that is the square root of the other definition.
</p>
<h3>How to measure the THD?</h3>
<p>
The THD can be measured in the following way: from a set of samples of the waveform, compute the Fourier transform to get the frequency spectrum. From there, sum the harmonics power and divide by the power in the fundamental frequency.
</p>
<h2>What is Total Harmonic Distortion + Noise (THD+N)?</h2>
<p>
THD+N is just the THD accounting with noise, i.e.:
$$\begin{equation}THD+N = \frac{\sum_{i&gt;1} P_i + P_{noise}}{P_1} = \frac{P_{total} - P_1}{P_1} \label{eq:thdn}\end{equation}$$
where $P_{total}$ now includes the noise power.
</p>
<h3>How to measure the THD+N</h3>
<p>
With a notch filter (band-reject), remove the band where the fundamental frequency lies. The remaining power will be the harmonics and noise. Now subtract the remaining signal from the original signal, leaving only the power in the fundamental frequency (or use a pass-band filter to remove all bands except where the fundamental frequency lies) and from there you get $P_1$.
Another option is to measure the total power $P_{total}$ and use again the pass-band filter to extract $P_1$. Then you can use the second form of $\eqref{eq:thdn}$.
</p>
<script type="text/javascript" src="../pages/thd.js"></script>
</div>
<script>
jQuery (function ($) {
	// avoid loading javascript for the two main pages, as it would replicate the toc
	if (page != 'contents' && page != 'about.me' && page != '404')
	{
		$.phd.onload('#pages');
		$("#pages a.page").attr({rel: 'external', target: '_blank'});
		$.phd.cite('#pages');
		//$.phd.ads('#pages');
	}
	/*$('#searchbox').hide();
	$('#searchtoggle').click( function () {
		if ($('#searchbox').toggle().is(':visible')) {			
			$(this).html('Search &#x25B2;');
		} else {
			$(this).html('Search &#x25BC;');
		}
		return false;
	});*/	
});
</script>
<link href="../main.css" rel="stylesheet" type="text/css">
</body>
</html>